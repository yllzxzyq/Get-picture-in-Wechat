### 路由协议



### IP协议

- 寻址规约
- 数据报分组

#### IP分组格式

![IP数据报](C:\Users\yllzxzyq\Desktop\笔记\IP数据报.png)

**固定字段：**

版本号：4位，标识IP数据报的版本号

首部长度：4位，

服务类型：8位，指示期望获得的服务

总长度：16位，IP数据报总长度

标识（ID）：16位，计数器产生，每次加1

标志位：3位，

- DF：1，禁止分片；0，可以分片
- MF：1，非最后一片；0，最后一片（可能分片，也可能没分）

片偏移：13位，一个IP分组分片封装IP分组数据的相对偏移量

生存时间：8位，IP在网络中可以通过的路由器数，每经过一个路由就减一

协议字段：8位，标识协议类型

首部校验和：16位，反码算数运算求和，和的反码作为校验和，实现对IP分组的检验

源IP地址、目的IP地址：各32位，标识IP地址

**可变字段：**

填充字段：补齐整个首部，成为4的倍数

**网络链路的最大传输单元MTU**

- 链路层数据帧可封装数据的上限
- 不同链路的MTU有所不同

#### IP编址

**接口：主机，路由器与物理链路的连接**

**IP地址**：32比特（IPv4）编号标识主机、路由器的**接口**

IP地址与每个接口关联

- **网络号**-高比特位,
- **子网号**-原网络主机号部分比特
- **主机号**-低比特位

**IP子网**

网络号相同而主机号不同的一些接口构成IP子网

并且不跨越路由器可以彼此物理联通的接口

有类编址：

A类地址，50%，0.0.0.0-127.255.255.255，8位网络号

B类地址，25%，128.0.0.0-191.255.255.255，16位网络号

C类地址，12.5%，192.0.0.0-223.255.255.255，24位网络号

D类地址，6.25%，224.0.0.0-239.255.255.255，多播地址

E类地址，6.25%，240.0.0.0-255.255.255.255，保留地址，作研究用

**特殊IP地址**

![特殊IP地址](C:\Users\yllzxzyq\Desktop\笔记\特殊IP地址.png)

**私有IP地址**

![私有IP地址](C:\Users\yllzxzyq\Desktop\笔记\私有IP地址.png)

**子网掩码**：

形如IP地址，32位，点分10进制

取值：

#### ICMP协议

- 差错报告
- 路由器指令

